---
title: "No Limit Hold'em"
output: html_notebook
---

----SANDBOX----

slansky(hand, big_blind, stack_size)
draw_analysis(street, pot, outs[vector], flop_bet, turn_bet, river_bet)


```{r}












```

LOAD LIBRARIES, LOAD FUNCTIONS, DEFINE CARDS

```{r}
library(dplyr)
library(readr)
library(tidyr)
library(stringr)


#defining cards

cards <- c('2h', '3h', '4h', '5h', '6h', '7h', '8h', '9h', 'Th', 'Jh', 'Qh', 'Kh', 'Ah', '2d', '3d', '4d', '5d', '6d', '7d', '8d', '9d', 'Td', 'Jd', 'Qd', 'Kd', 'Ad', '2c', '3c', '4c', '5c', '6c', '7c', '8c', '9c', 'Tc', 'Jc', 'Qc', 'Kc', 'Ac', '2s', '3s', '4s', '5s', '6s', '7s', '8s', '9s', 'Ts', 'Js', 'Qs', 'Ks', 'As')

slansky <- function(your_hand, big_blind, stack_size) {
  hands <- hands_sc$hand
  sc_nums <- hands_sc$slansky_chubukov_num
  hand_num = which(hands == your_hand)
  sc_num = sc_nums[hand_num]
  sc_num_bb = sc_num / 2
  move_in_num = sc_num_bb * big_blind
  if (move_in_num < stack_size) {return(writeLines(
    c(paste(paste('=== Slansky-Chubukov All-In Value:', move_in_num), '==='),
      '++ Consider Moving All-In... ++')))}
  else {return(writeLines(
    c(paste(paste('== Slansky-Chubukov All-In Value:', move_in_num), '=='),
      '-- Not a Clear Shove... --')))}
} 

draw_analysis <- function(street, pot, outs, flop_bet, turn_bet, river_bet) {
  if (street == 'flop') {
    deck = 47
    pot_odds = (flop_bet / pot) * 100
    pot_odds2 = 100 / pot_odds
    eff_odds = ((flop_bet + turn_bet + river_bet) / (pot + flop_bet + turn_bet + river_bet)) * 100
    eff_odds2 = 100 / eff_odds
    imp_odds = (flop_bet / (pot + flop_bet + turn_bet + river_bet)) * 100
    imp_odds2 = 100 / imp_odds
    hand_odds = (length(outs) / deck) * 100
    hand_odds2 = 100 / hand_odds
  }
  if (street == 'turn') {
    deck = 46
    pot_odds = (turn_bet / pot) * 100
    pot_odds2 = 100 / pot_odds
    eff_odds = ((turn_bet + river_bet) / (pot + turn_bet + river_bet)) * 100
    eff_odds2 = 100 / eff_odds
    imp_odds = (turn_bet / (pot + turn_bet + river_bet)) * 100
    imp_odds2 = 100 / imp_odds
    hand_odds = (length(outs) / deck) * 100
    hand_odds2 = 100 / hand_odds
  }
  if (hand_odds >= pot_odds) {pot_odds_test = '++ Worth a Call by Pot Odds ++'}
  if (hand_odds < pot_odds) {pot_odds_test = '-- NOT Worth a Call by Pot Odds --'}
  if (hand_odds >= imp_odds) {imp_odds_test = '++ Worth a Call by Implied Odds ++'}
  if (hand_odds < imp_odds) {imp_odds_test = '-- NOT Worth a Call by Implied Odds --'}
  if (hand_odds >= eff_odds) {eff_odds_test = '++ Worth a Call by Effective odds ++'}
  if (hand_odds < eff_odds) {eff_odds_test = '-- NOT Worth a Call by Effective Odds --'}
  return(writeLines(c(
    paste(paste(paste(paste('=== Odds of making your hand:', round(hand_odds, digits = 2)), '% OR'), round(hand_odds2, digits = 2)), '- 1 ==='),
    '',
    paste(paste(paste(paste('=== Pot Odds:', round(pot_odds, digits = 2)), '% OR'), pot_odds2), '- 1 ==='),
    pot_odds_test,
    '',
    paste(paste(paste(paste('=== Implied Odds:', round(imp_odds, digits = 2)), '% OR'), round(imp_odds2, digits =2)), '- 1 ==='),
    imp_odds_test,
    '',
    paste(paste(paste(paste('=== Effective Odds:', round(eff_odds, digits = 2)), '% OR'), round(eff_odds2, digits = 2)), '- 1 ==='),
    eff_odds_test)
  ))
}



```









GENERATE POSSIBLE HOLE HANDS FOR TWO PLAYERS

```{r}

#generating your hands

hero_hands <- expand.grid(cards, cards)

hero_hands <- hero_hands %>%
  rename(hero.hand1 = Var1, hero.hand2 = Var2)

hero_hands <- hero_hands %>%
  filter(hero.hand1 != hero.hand2)

head(hero_hands)

#generating opponent's hands

vil_hands <- expand.grid(cards, cards)

vil_hands <- vil_hands %>%
  rename(vil.hand1 = Var1, vil.hand2 = Var2)

vil_hands <- vil_hands %>%
  filter(vil.hand1 != vil.hand2)

head(vil_hands)

#generating all combinations of your hands and opponent's hands

hole_hands <- crossing(hero_hands, vil_hands)

hole_hands <- hole_hands %>%
  filter(hero.hand1 != vil.hand1, hero.hand1 != vil.hand2, hero.hand2 != vil.hand1, hero.hand2 != vil.hand2)

```

GENERATE POSSIBLE BOARDS 

```{r}

#generating flops

flops <- expand.grid(cards, cards, cards) 

flops <- flops %>%
  rename(flop1 = Var1, flop2 = Var2, flop3 = Var3)

flops <- flops %>%
  filter(flop1 != flop2, flop1 != flop3, flop2 != flop3)

head(flops)

#generating turns

turns <- as.data.frame(cards)

turns <- turns %>%
  rename(turn = cards)

head(turns)

#generating all combinations of flops and turns

flop_turns <- crossing(flops, turns)

flop_turns <- flop_turns %>%
  filter(flop1 != turn, flop2 != turn, flop3 != turn)

#generating rivers

rivers <- as.data.frame(cards)

rivers <- rivers %>%
  rename(river = cards)

head(rivers)

#generating all combinations of flops, turns, and rivers
 
boards <- crossing(flop_turns, rivers)

boards <- boards %>%
  filter(flop1 != river, flop2 != river, flop3 != river, turn != river)

```

GENERATE ALL POSSIBLE HEADS UP HANDS

```{r}

#generating all combinations of boards and hole hands

hands <- crossing(boards, hole_hands)

```

POT ODDS

```{r}

#define function

pot_odds <- function(pot, bet) {
  pot_odd = (bet / pot) * 100
  return(pot_odd)
}

#e.x "there is $100 in the pot and opponent bets $20

pot_odds(100,20)

```

EFFECTIVE ODDS

```{r}

#define function

effective_odds <- function(street, pot, preflop_bet, flop_bet, turn_bet, river_bet) {
  if (street == 'preflop') {eff_odds = ((preflop_bet + flop_bet + turn_bet + river_bet) / (pot + preflop_bet + flop_bet + turn_bet + river_bet)) * 100}
  if (street == 'flop') {eff_odds = ((flop_bet + turn_bet + river_bet) / (pot + flop_bet + turn_bet + river_bet)) * 100}
  if (street == 'turn') {eff_odds = ((turn_bet + river_bet) / (pot + turn_bet + river_bet)) * 100}
  return(eff_odds)
}

#e.x. "there is $100 in the pot at the moment and three more $20 betting rounds"

effective_odds('flop', 100, 0, 20, 20, 20)

```

IMPLIED ODDS

```{r}

implied_odds <- function(pot, bet, future_profit) {
  imp_odds = (bet / (pot + future_profit)) * 100
  return(imp_odds)
  }

#e.x. "there is $50 in the pot and it is $10 to you and you should average about $100 further profit when you make your hand"

implied_odds(50, 10, 100)

```

HAND ODDS


```{r}

your_odds <- function(street, one_draw_outs, two_draw_outs) {
  if (street == 'flop') {deck = 47}
  if (street == 'turn') {deck = 46}
  one_draw_odds = length(one_draw_outs) / deck
  two_draw_odds = (length(two_draw_outs) / deck) * ((length(two_draw_outs) - 1) / (deck - 1))
  draw_overlap = intersect(one_draw_outs, two_draw_outs)
  draw_overlap_odds = length(draw_overlap) / deck
  odds = ((one_draw_odds + two_draw_odds) - draw_overlap_odds) * 100
  return(odds)
}

#have AsJs, need an backdoor spade flush, a king, queen, or ace to win

your_odds('flop', c('Ks', 'Kc', 'Kd', 'Kh', 'Qs', 'Qc', 'Qd', 'Qh', 'Ad', 'Ac', 'Ah'), c('Ks', 'Qs', 'Ts', '9s', '8s', '7s', '6s', '5s', '4s', '3s', '2s'))


```

Slansky-Chubukov 

```{r}

slansky <- function(your_hand, big_blind, stack_size) {
  hands <- hands_sc$hand
  sc_nums <- hands_sc$slansky_chubukov_num
  hand_num = which(hands == your_hand)
  sc_num = sc_nums[hand_num]
  sc_num_bb = sc_num / 2
  move_in_num = sc_num_bb * big_blind
  if (move_in_num < stack_size) {return(writeLines(
    c(paste(paste('== Slansky-Chubukov All-In Value:', move_in_num), '=='),
      '== Consider Moving All-In... ==')))}
  else {return(writeLines(
    c(paste(paste('== Slansky-Chubukov All-In Value:', move_in_num), '=='),
      '== Not a Clear Shove... ==')))}
} 

```

Hand Odds v2

```{r}

your_odds <- function(street, outs) {
  if (street == 'flop') {deck = 47}
  if (street == 'turn') {deck = 46}
  odds = length(outs) / deck * 100
  return(odds)
}

```

Complete Hand Odds Analyzer

```{r}

call_analysis <- function(street, pot, outs, flop_bet, turn_bet, river_bet) {
  if (street == 'flop') {
    deck = 47
    pot_odds = (flop_bet / pot) * 100
    pot_odds2 = 100 / pot_odds
    eff_odds = ((flop_bet + turn_bet + river_bet) / (pot + flop_bet + turn_bet + river_bet)) * 100
    eff_odds2 = 100 / eff_odds
    imp_odds = (flop_bet / (pot + flop_bet + turn_bet + river_bet)) * 100
    imp_odds2 = 100 / imp_odds
    hand_odds = (length(outs) / deck) * 100
    hand_odds2 = 100 / hand_odds
  }
  if (street == 'turn') {
    deck = 46
    pot_odds = (turn_bet / pot) * 100
    pot_odds2 = 100 / pot_odds
    eff_odds = ((turn_bet + river_bet) / (pot + turn_bet + river_bet)) * 100
    eff_odds2 = 100 / eff_odds
    imp_odds = (turn_bet / (pot + turn_bet + river_bet)) * 100
    imp_odds2 = 100 / imp_odds
    hand_odds = (length(outs) / deck) * 100
    hand_odds2 = 100 / hand_odds
  }
  if (hand_odds >= pot_odds) {pot_odds_test = '++ Worth a Call by Pot Odds ++'}
  if (hand_odds < pot_odds) {pot_odds_test = '-- NOT Worth a Call by Pot Odds --'}
  if (hand_odds >= imp_odds) {imp_odds_test = '++ Worth a Call by Implied Odds ++'}
  if (hand_odds < imp_odds) {imp_odds_test = '-- NOT Worth a Call by Implied Odds --'}
  if (hand_odds >= eff_odds) {eff_odds_test = '++ Worth a Call by Effective odds ++'}
  if (hand_odds < eff_odds) {eff_odds_test = '-- NOT Worth a Call by Effective Odds --'}
  return(writeLines(c(
    paste(paste(paste(paste('=== Odds of making your hand:', round(hand_odds, digits = 2)), '% OR'), round(hand_odds2, digits = 2)), '- 1 ==='),
    '',
    paste(paste(paste(paste('=== Pot Odds:', round(pot_odds, digits = 2)), '% OR'), pot_odds2), '- 1 ==='),
    pot_odds_test,
    '',
    paste(paste(paste(paste('=== Implied Odds:', round(imp_odds, digits = 2)), '% OR'), round(imp_odds2, digits =2)), '- 1 ==='),
    imp_odds_test,
    '',
    paste(paste(paste(paste('=== Effective Odds:', round(eff_odds, digits = 2)), '% OR'), round(eff_odds2, digits = 2)), '- 1 ==='),
    eff_odds_test)
  ))
}


call_analysis('turn', 100, c('Ts', '9s', '8s', '7s', '6s', '5s', '4s', '3s', '2s'), 0, 20, 70)

```









